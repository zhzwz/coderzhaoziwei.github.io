<!DOCTYPE html>
<html lang="zh-CN" class="min-h-screen bg-image bg-cover bg-center bg-fixed"> <head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8"> <meta charset="utf-8"> <meta name="viewport" content="width=device-width, initial-scale=1.0"> <!-- Begin Jekyll SEO tag v2.7.1 --> <title>Homebrew 安装过程记录 | Coder Zhao’s Zone</title> <meta name="generator" content="Jekyll v4.2.1"> <meta property="og:title" content="Homebrew 安装过程记录"> <meta name="author" content="Coder Zhao"> <meta property="og:locale" content="zh_CN"> <meta name="description" content="Homebrew 实在是 macOS 安装软件的一大利器，用过了就再也丢不掉。"> <meta property="og:description" content="Homebrew 实在是 macOS 安装软件的一大利器，用过了就再也丢不掉。"> <link rel="canonical" href="https://coderzhaoziwei.github.io/posts/install-homebrew"> <meta property="og:url" content="https://coderzhaoziwei.github.io/posts/install-homebrew"> <meta property="og:site_name" content="Coder Zhao’s Zone"> <meta property="og:type" content="article"> <meta property="article:published_time" content="2021-01-15T00:00:00+00:00"> <meta name="twitter:card" content="summary"> <meta property="twitter:title" content="Homebrew 安装过程记录"> <script type="application/ld+json"> {"headline":"Homebrew 安装过程记录","dateModified":"2021-01-15T00:00:00+00:00","datePublished":"2021-01-15T00:00:00+00:00","description":"Homebrew 实在是 macOS 安装软件的一大利器，用过了就再也丢不掉。","mainEntityOfPage":{"@type":"WebPage","@id":"https://coderzhaoziwei.github.io/posts/install-homebrew"},"url":"https://coderzhaoziwei.github.io/posts/install-homebrew","@type":"BlogPosting","author":{"@type":"Person","name":"Coder Zhao"},"@context":"https://schema.org"}</script> <!-- End Jekyll SEO tag --> <!-- Begin Jekyll Feed --> <link type="application/atom+xml" rel="alternate" href="https://coderzhaoziwei.github.io/feed.xml" title="Coder Zhao’s Zone"> <!-- End Jekyll Feed --> <!-- Tailwind --> <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/tailwindcss@2/dist/tailwind.min.css"> <!-- Primer Markdown --> <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/primer-markdown@4.0.0/build/build.css"> <!-- HighlightJS --> <script src="https://cdn.jsdelivr.net/gh/highlightjs/cdn-release@11.0.1/build/highlight.min.js"></script> <script>hljs.highlightAll();</script> <!-- HighlightJS Theme VS2015 --> <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/highlight.js@11.0.1/styles/vs2015.css"> <!-- MathJax @see https://www.mathjax.org --> <!-- Theme --> <link rel="stylesheet" href="/assets/css/style.css"> <style id="ThemeColor"> :root { --theme-50: var(--red-50); --theme-100: var(--red-100); --theme-200: var(--red-200); --theme-300: var(--red-300); --theme-400: var(--red-400); --theme-500: var(--red-500); --theme-600: var(--red-600); --theme-700: var(--red-700); --theme-800: var(--red-800); --theme-900: var(--red-900); } </style> <style id="ThemeBackgroundImage">.bg-image { background-image: url("https://cdn.jsdelivr.net/gh/coderzhaoziwei/jekyll-theme-acg/assets/images/pixiv86925095.png"); }</style> <link rel="icon" type="image/svg+xml" href="/assets/favicon.svg"> </head> <body class="flex flex-col items-center bg-black bg-opacity-50"> <header class="w-full fixed z-50 select-none bg-red-600 bg-opacity-10 bg-blur"> <nav class="p-4 font-serif text-xl text-red-50 flex justify-between"> <a class="hover:text-red-400 text-2xl" href="/">Coder Zhao’s Zone</a> <div class="hidden md:block space-x-4"> <a class="hover:text-red-400" href="/categories">分类</a> <a class="hover:text-red-400" href="/tags">标签</a> <a class="hover:text-red-400" href="/about">关于</a> </div> <style>#theme-menu:hover > #theme-menu-dropdown { display: block; }</style> <div id="theme-menu" class="md:hidden"> <button class="hover:outline-none hover:text-red-400"> <svg xmlns="http://www.w3.org/2000/svg" class="h-6 w-6" fill="none" viewbox="0 0 24 24" stroke="currentColor"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M4 6h16M4 12h16M4 18h16"></path></svg> </button> <div class="hidden origin-top-right absolute right-1 rounded-md py-1 bg-red-100 bg-opacity-50 focus:block focus:outline-none" id="theme-menu-dropdown"> <a class="block px-4 py-2 text-sm text-red-600 hover:bg-red-200" href="/categories">分类</a> <a class="block px-4 py-2 text-sm text-red-600 hover:bg-red-200" href="/tags">标签</a> <a class="block px-4 py-2 text-sm text-red-600 hover:bg-red-200" href="/about">关于</a> </div> </div> </nav> </header> <div class="w-acg min-h-screen py-16"> <div class="w-full flex flex-col justify-center items-center content-center text-red-50 py-32"> <!-- title --> <div class="text-center text-4xl font-serif py-8"> Homebrew 安装过程记录 </div> <!-- description --> <div class="text-center text-base font-sans py-8">Homebrew 实在是 macOS 安装软件的一大利器，用过了就再也丢不掉。</div> <!-- categories.html & tags.html --> <div class="flex flex-wrap justify-center items-center content-center select-none"> </div> </div> <!-- article --> <div class="flex flex-wrap"> <div class="flex-grow"> <a class="mx-px text-opacity-75 flex items-center select-none text-sm text-red-500"> <!-- svg --> <svg class=" w-4 h-4 " xmlns="http://www.w3.org/2000/svg" fill="none" viewbox="0 0 24 24" stroke="currentColor"> <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M8 7V3m8 4V3m-9 8h10M5 21h14a2 2 0 002-2V7a2 2 0 00-2-2H5a2 2 0 00-2 2v12a2 2 0 002 2z"> </path></svg> <!-- text --> <span class="inline-block p-1 whitespace-nowrap">2021-01-15</span> <!-- count --> </a> </div> <div class="flex flex-wrap"> <a class="mx-px text-opacity-75 flex items-center select-none text-sm text-red-500" href="/tags/homebrew"> <!-- svg --> <svg class=" w-4 h-4 " xmlns="http://www.w3.org/2000/svg" fill="none" viewbox="0 0 24 24" stroke="currentColor"> <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M7 7h.01M7 3h5c.512 0 1.024.195 1.414.586l7 7a2 2 0 010 2.828l-7 7a2 2 0 01-2.828 0l-7-7A1.994 1.994 0 013 12V7a4 4 0 014-4z"> </path></svg> <!-- text --> <span class="inline-block p-1 whitespace-nowrap">homebrew</span> <!-- count --> </a> </div> </div> <article class="w-full my-4 mx-auto p-4 rounded-lg text-black bg-red-50 bg-opacity-75 markdown-body"> <h1>Homebrew 安装过程记录</h1> <ul id="toc" class="toc">
<li class="toc-li-2"><a class="toc-a" href="#%E5%89%8D%E8%A8%80">前言</a></li>
<li class="toc-li-2"><a class="toc-a" href="#%E7%AE%80%E4%BB%8B">简介</a></li>
<li class="toc-li-2">
<a class="toc-a" href="#%E5%AE%89%E8%A3%85">安装</a><ul class="toc-sub-2">
<li class="toc-li-3"><a class="toc-a" href="#%E5%AE%89%E8%A3%85%E5%A4%B1%E8%B4%A5">安装失败</a></li>
<li class="toc-li-3"><a class="toc-a" href="#%E6%B7%BB%E5%8A%A0-dns-%E8%A7%A3%E6%9E%90">添加 DNS 解析</a></li>
<li class="toc-li-3"><a class="toc-a" href="#%E4%BD%BF%E7%94%A8%E5%9B%BD%E5%86%85%E9%95%9C%E5%83%8F">使用国内镜像</a></li>
</ul>
</li>
<li class="toc-li-2"><a class="toc-a" href="#%E5%B8%B8%E7%94%A8%E6%8C%87%E4%BB%A4">常用指令</a></li>
<li class="toc-li-2"><a class="toc-a" href="#%E5%B8%B8%E7%94%A8%E8%BD%AF%E4%BB%B6">常用软件</a></li>
<li class="toc-li-2"><a class="toc-a" href="#%E7%BB%93%E8%AF%AD">结语</a></li>
</ul> <h2 id="前言">前言</h2> <p>在备份了重要资料之后，我抹盘安装了苹果的新一代操作系统 <code class="language-plaintext highlighter-rouge">macOS Big Sur 11.1</code>，于是才有了这篇记录重新安装 <code class="language-plaintext highlighter-rouge">Homebrew 2.7.3</code> 的过程。</p> <p>目前我对于 <code class="language-plaintext highlighter-rouge">Big Sur</code> 的体验还算良好，只遇到了一些小问题。比如在某些情况下，无法切换至搜狗输入法进行中文输入。建议追求系统环境稳定、不愿意折腾的朋友，对于系统的更新可以再等一等。</p> <p><em>CoderZhao 2021-01-16</em></p> <ul> <li><a href="https://brew.sh">Homebrew Homepage</a></li> <li><a href="https://brew.sh/index_zh-cn">Homebrew 官网（简体中文）</a></li> </ul> <blockquote> <p>补充：无法切换至搜狗输入法进行中文输入的情况，重启之后就正常了。除了不再能运行 32 位的程序，后续使用没有再遇到其他问题。</p> </blockquote> <h2 id="简介">简介</h2> <p>Homebrew 官网的自我介绍是：macOS（或 Linux）缺失的软件包的管理器，我认为这句话名副其实。使用 Homebrew 在 macOS 中可以快速安装各种软件包或应用程序，而且操作非常简单。</p> <p>例如，运行命令 <code class="language-plaintext highlighter-rouge">brew install node</code> 可以安装 <code class="language-plaintext highlighter-rouge">node.js</code>，运行命令 <code class="language-plaintext highlighter-rouge">brew install wechat</code> 可以安装微信，运行命令 <code class="language-plaintext highlighter-rouge">brew uninstall wechat</code> 可以卸载微信。软件包的运行依赖 Homebrew 也会自动安装，所有文件将安装到指定目录（默认 <code class="language-plaintext highlighter-rouge">/usr/local/Homebrew</code>）。</p> <h2 id="安装">安装</h2> <h3 id="安装失败">安装失败</h3> <p>根据官网介绍，安装 Homebrew 只需要将以下命令粘贴至终端运行即可。</p> <div class="language-sh highlighter-rouge"><div class="highlight"><pre class="highlight"><code>/bin/bash <span class="nt">-c</span> <span class="s2">"</span><span class="si">$(</span>curl <span class="nt">-fsSL</span> https://raw.githubusercontent.com/Homebrew/install/HEAD/install.sh<span class="si">)</span><span class="s2">"</span>
</code></pre></div></div> <p>由于网络问题，国内用户通常会安装失败。</p> <div class="language-md highlighter-rouge"><div class="highlight"><pre class="highlight"><code>curl: (7) Failed to connect to raw.githubusercontent.com port 443: Connection refused
</code></pre></div></div> <p>连接被拒绝，无法连接到 <code class="language-plaintext highlighter-rouge">raw.githubusercontent.com</code> 的 443 端口。</p> <h3 id="添加-dns-解析">添加 DNS 解析</h3> <p>我直接在浏览器地址栏粘贴 <code class="language-plaintext highlighter-rouge">https://raw.githubusercontent.com/Homebrew/install/HEAD/install.sh</code>，发现仍然无法连接，可能是国内网络环境存在 DNS 污染，可以尝试手动添加解析。</p> <p>想要手动添加解析，就需要知道真实的 IP 地址。访问 https://www.ipaddress.com 可以查询到 <code class="language-plaintext highlighter-rouge">raw.githubusercontent.com</code> 的 IP 地址，我的查询结果如下。</p> <table> <thead> <tr> <th style="text-align: left">Domain</th> <th style="text-align: left">githubusercontent.com</th> </tr> </thead> <tbody> <tr> <td style="text-align: left">IP Address</td> <td style="text-align: left">199.232.96.133</td> </tr> <tr> <td style="text-align: left">Web Server Location</td> <td style="text-align: left">United States</td> </tr> </tbody> </table> <p>这里我查询到的 IP 地址是 <code class="language-plaintext highlighter-rouge">199.232.96.133</code>，不同地区不同时间查询到的结果可能不一致，请以实际查询结果为准。</p> <p>下面这条命令会在 <code class="language-plaintext highlighter-rouge">hosts</code> 文件末尾加上一行 <code class="language-plaintext highlighter-rouge">199.232.96.133 raw.githubusercontent.com</code>，由于修改的是系统只读文件，需要输入用户密码。</p> <div class="language-zsh highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nb">sudo</span> /bin/zsh <span class="nt">-c</span> <span class="s2">"echo '199.232.96.133 raw.githubusercontent.com' &gt;&gt; /etc/hosts"</span>
</code></pre></div></div> <p><code class="language-plaintext highlighter-rouge">hosts</code> 文件修改之后，我的浏览器就可以直接访问 <code class="language-plaintext highlighter-rouge">raw.githubusercontent.com</code> 了，直接执行官网的指令也不会直接提示连接失败了，但是安装速度仍然极慢，还时不时中断导致失败。</p> <h3 id="使用国内镜像">使用国内镜像</h3> <p>为了加速安装，我使用了中科大（USTC）的镜像资源，详细说明可以查阅<a href="http://mirrors.ustc.edu.cn/help">中国科学技术大学镜像资源帮助文档</a>。</p> <ul> <li>Homebrew 源代码仓库替换为 USTC 镜像：</li> </ul> <div class="language-zsh highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nb">cd</span> <span class="s2">"</span><span class="si">$(</span>brew <span class="nt">--repo</span><span class="si">)</span><span class="s2">"</span>
git remote set-url origin https://mirrors.ustc.edu.cn/brew.git
</code></pre></div></div> <ul> <li>Homebrew 预编译二进制软件包替换为 USTC 镜像：（<code class="language-plaintext highlighter-rouge">.zshrc</code> 是 zsh 的配置文件，bash 请自行查看文档）</li> </ul> <div class="language-zsh highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nb">echo</span> <span class="s1">'export HOMEBREW_BOTTLE_DOMAIN=https://mirrors.ustc.edu.cn/homebrew-bottles'</span> <span class="o">&gt;&gt;</span> ~/.zshrc
<span class="nb">source</span> ~/.zshrc
</code></pre></div></div> <ul> <li>Homebrew 核心软件仓库替换为 USTC 镜像：</li> </ul> <div class="language-zsh highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nb">cd</span> <span class="s2">"</span><span class="si">$(</span>brew <span class="nt">--repo</span><span class="si">)</span><span class="s2">"</span>/Library/Taps/homebrew/homebrew-core
git remote set-url origin https://mirrors.ustc.edu.cn/homebrew-core.git
</code></pre></div></div> <ul> <li>Homebrew cask 软件仓库替换为 USTC 镜像：</li> </ul> <div class="language-zsh highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nb">cd</span> <span class="s2">"</span><span class="si">$(</span>brew <span class="nt">--repo</span><span class="si">)</span><span class="s2">"</span>/Library/Taps/homebrew/homebrew-cask
git remote set-url origin https://mirrors.ustc.edu.cn/homebrew-cask.git
</code></pre></div></div> <blockquote> <p>Homebrew 主目录 <code class="language-plaintext highlighter-rouge">$(brew --repo)</code> 的具体路径在我这里是 <code class="language-plaintext highlighter-rouge">/usr/local/Homebrew</code>，如果遇到子目录不存在导致 <code class="language-plaintext highlighter-rouge">cd</code> 命令失败的情况，可以先手动创建 <code class="language-plaintext highlighter-rouge">/usr/local/Homebrew/Library/Taps/homebrew</code> 再创建两个子目录 <code class="language-plaintext highlighter-rouge">homebrew-core</code> 和 <code class="language-plaintext highlighter-rouge">homebrew-cask</code>。</p> </blockquote> <h2 id="常用指令">常用指令</h2> <table> <thead> <tr> <th style="text-align: left">指令</th> <th style="text-align: left">说明</th> </tr> </thead> <tbody> <tr> <td style="text-align: left">brew search {AppName}</td> <td style="text-align: left">搜索软件</td> </tr> <tr> <td style="text-align: left">brew info {AppName}</td> <td style="text-align: left">查看软件</td> </tr> <tr> <td style="text-align: left">brew install {AppName}</td> <td style="text-align: left">安装软件</td> </tr> <tr> <td style="text-align: left">brew upgrade {AppName}</td> <td style="text-align: left">更新软件</td> </tr> <tr> <td style="text-align: left">brew uninstall {AppName}</td> <td style="text-align: left">卸载软件</td> </tr> <tr> <td style="text-align: left">brew update</td> <td style="text-align: left">更新全部</td> </tr> <tr> <td style="text-align: left">brew list</td> <td style="text-align: left">显示全部</td> </tr> <tr> <td style="text-align: left">brew help</td> <td style="text-align: left">帮助信息</td> </tr> </tbody> </table> <h2 id="常用软件">常用软件</h2> <p>保存为文件 <code class="language-plaintext highlighter-rouge">install.sh</code>，需要运行命令 <code class="language-plaintext highlighter-rouge">zsh install.sh</code>。</p> <div class="language-sh highlighter-rouge"><div class="highlight"><pre class="highlight"><code>brew <span class="nb">install </span>node               <span class="c"># node.js</span>
brew <span class="nb">install </span>yarn
brew <span class="nb">install </span>ffmpeg
brew <span class="nb">install </span>you-get            <span class="c"># 下载工具（需要 ffmpeg 前置）</span>

brew <span class="nb">install </span>visual-studio-code <span class="c"># 编辑器</span>
brew <span class="nb">install </span>clashx             <span class="c"># 网络代理</span>
brew <span class="nb">install </span>github             <span class="c"># github-desktop</span>
brew <span class="nb">install </span>tinypng4mac        <span class="c"># 图片压缩</span>
brew <span class="nb">install </span>qq                 <span class="c"># 腾讯</span>
brew <span class="nb">install </span>wechat             <span class="c"># 微信</span>
brew <span class="nb">install </span>the-unarchiver     <span class="c"># 压缩解压</span>
brew <span class="nb">install </span>caffeine           <span class="c"># 屏幕常亮</span>
brew <span class="nb">install </span>motrix             <span class="c"># 下载器 Motrix</span>

brew <span class="nb">install </span>microsoft-edge     <span class="c"># edge</span>
<span class="c"># 安装 edge 之后，脚本会自动安装 microsoft-auto-update，需要用户手动输入密码。</span>

brew <span class="nb">install </span>sogouinput         <span class="c"># 搜狗输入法</span>
<span class="c"># 脚本下载搜狗输入法程序的安装包之后，需要用户手动安装，文件路径是 `/usr/local/Caskroom/sogouinput`。</span>
</code></pre></div></div> <h2 id="结语">结语</h2> <p>类似这种由于网络问题而导致变得复杂的操作流程，最简单的解决办法其实是使用网络代理。但是网络代理的使用不适合所有的用户，于是就要使用到相应的国内镜像资源。</p> <p>我记得几年前第一次安装 Homebrew 的时候，官方的安装命令是使用的 <code class="language-plaintext highlighter-rouge">Ruby</code>，现在（2021）已经改为了 <code class="language-plaintext highlighter-rouge">Bash</code>。如果现在还是参考一些过时的文章，很可能看了反而一头雾水，所以遇到问题一定要查询最新的信息。</p> </article> <div class="w-full mx-auto flex justify-between space-x-4"> <!-- prev --> <a class="w-1/2 p-4 flex items-center rounded-lg bg-red-50 bg-opacity-75" href="/posts/commit-message"> <svg class=" flex-shrink-0 text-red-600 w-6 h-6 " xmlns="http://www.w3.org/2000/svg" fill="none" viewbox="0 0 24 24" stroke="currentColor"> <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M11 15l-3-3m0 0l3-3m-3 3h8M3 12a9 9 0 1118 0 9 9 0 01-18 0z"> </path></svg> <span class="ml-4 text-black">Commit Message 规范</span> </a> <!-- next --> <a class="w-1/2 p-4 flex flex-row-reverse items-center rounded-lg bg-red-50 bg-opacity-75" href="/posts/jekyll-note"> <svg class=" flex-shrink-0 text-red-600 w-6 h-6 " xmlns="http://www.w3.org/2000/svg" fill="none" viewbox="0 0 24 24" stroke="currentColor"> <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M13 9l3 3m0 0l-3 3m3-3H8m13 0a9 9 0 11-18 0 9 9 0 0118 0z"> </path></svg> <span class="mr-4 text-black">关于 Jekyll 的资料</span> </a> </div> <!-- posts --> </div> <footer class="w-full mt-4 p-2 text-sm text-red-100 "> <p class="text-center"> Powered by <a class="text-red-400" href="https://jekyllrb.com" target="_block">Jekyll</a> · <a class="text-red-400" href="https://github.com/coderzhaoziwei/jekyll-theme-acg" target="_block">Jekyll Theme ACG</a> </p> <p class="text-center"> Copyright 2021 <a class="text-red-400">Coder Zhao</a> · All rights reserved. </p> </footer> </body> </html>
